<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using Visual Studio Code as an add-on editor &mdash; Zeiss Industry Quality Solutions  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Zeiss Industry Quality Solutions
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Using Visual Studio Code as an add-on editor</a><ul>
<li><a class="reference internal" href="#setup">Setup</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#connecting">Connecting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#editing">Editing</a><ul>
<li><a class="reference internal" href="#creating-scripts">Creating scripts</a></li>
<li><a class="reference internal" href="#executing-scripts">Executing scripts</a></li>
<li><a class="reference internal" href="#recording-commands">Recording commands</a></li>
<li><a class="reference internal" href="#inserting-elements">Inserting elements</a></li>
<li><a class="reference internal" href="#inserting-keywords">Inserting keywords</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging">Debugging</a><ul>
<li><a class="reference internal" href="#start-debugging">Start debugging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-defined-script-dialogs">User defined script dialogs</a><ul>
<li><a class="reference internal" href="#create-new-script-dialog">Create new script dialog</a></li>
</ul>
</li>
<li><a class="reference internal" href="#faq">FAQ</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#how-do-i-set-a-shortcut-to-toggle-the-recording-mode">How do I set a shortcut to toggle the recording mode ?</a></li>
<li><a class="reference internal" href="#how-do-i-set-shortcuts-for-starting-the-current-script-in-the-gom-host">How do I set shortcuts for starting the current script in the GOM host ?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#script-editing">Script editing</a><ul>
<li><a class="reference internal" href="#can-i-use-local-workspaces-from-disk-instead-of-the-application-script-database-for-my-project">Can I use local workspaces from disk instead of the application script database for my project ?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dialog-editing">Dialog editing</a><ul>
<li><a class="reference internal" href="#i-cannot-edit-all-aspects-of-the-user-defined-script-dialogs-in-visual-studio-code">I cannot edit all aspects of the user defined script dialogs in visual studio code ?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#when-using-intellisense-completion-the-keyword-list-stalls">When using IntelliSense completion, the keyword list stalls</a></li>
<li><a class="reference internal" href="#when-starting-both-the-application-and-a-script-from-within-visual-studio-code-crashes-can-happen">When starting both the application and a script from within Visual Studio Code, crashes can happen</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Zeiss Industry Quality Solutions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Using Visual Studio Code as an add-on editor</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/GOMSoftware/howtos/using_vscode_editor/using_vscode_editor.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-visual-studio-code-as-an-add-on-editor">
<h1>Using Visual Studio Code as an add-on editor<a class="headerlink" href="#using-visual-studio-code-as-an-add-on-editor" title="Permalink to this heading"></a></h1>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading"></a></h2>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Installation</p>
<ul>
<li><p>Install the extension directly from the Visual Studio Code extension tab or from the marketplace.</p></li>
<li><p>VSCode version 1.64 or higher is needed for this to work properly.</p>
<p><img alt="" src="../../../_images/extension.png" /></p>
</li>
</ul>
</li>
<li><p>Configure connection</p>
<ul>
<li><p>Ensure that the python API preferences in the GOM software are set up properly</p>
<p><img alt="" src="../../../_images/setup2.png" /></p>
</li>
<li><p>Ensure that the python API settings are correct in VSCode and are matching these in the GOM software:</p>
<p><img alt="" src="../../../_images/setup4.png" /></p>
</li>
</ul>
</li>
</ol>
</section>
<section id="connecting">
<h3>Connecting<a class="headerlink" href="#connecting" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Have a GOM software running as a host</p></li>
<li><p>In the VSCode status bar, the connection status is displayed:</p>
<p><img alt="" src="../../../_images/connecting1.png" /></p>
</li>
<li><p>Press onto the “GOM host: Disconnected” status entry to connect to the host application.</p></li>
<li><p>After the connection has been established,</p>
<ul>
<li><p>the connection status will reflect that and</p></li>
<li><p>the GOM softwares add-on editor content is mirrored and displayed in VSCode:</p>
<p><img alt="" src="../../../_images/connecting2.png" /></p>
</li>
</ul>
</li>
</ol>
</section>
</section>
<section id="editing">
<h2>Editing<a class="headerlink" href="#editing" title="Permalink to this heading"></a></h2>
<section id="creating-scripts">
<h3>Creating scripts<a class="headerlink" href="#creating-scripts" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Select ‘New GOM script’ from the file explorers right mouse menu.</p></li>
<li><p>Enter unique name for that script.</p></li>
</ol>
<p><img alt="" src="../../../_images/editing1.png" /></p>
</section>
<section id="executing-scripts">
<h3>Executing scripts<a class="headerlink" href="#executing-scripts" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Select script to execute in the VSCode explorer.</p>
<ul class="simple">
<li><p>The script can either reside in the mirrored application scripting database or be a local file from any other workspace location.</p></li>
</ul>
</li>
<li><p>Select “Run script in GOM host” from the editors toolbar</p></li>
<li><p>The script outputs will be shown in the “debug console”.</p>
<p><img alt="" src="../../../_images/editing2.png" /></p>
</li>
</ol>
</section>
<section id="recording-commands">
<h3>Recording commands<a class="headerlink" href="#recording-commands" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Select the script to record commands into to show it in the editor.</p></li>
<li><p>In that editor, select “Record commands” from the editor toolbar.</p></li>
<li><p>Execute commands in the GOM application</p>
<ul>
<li><p>The executed commands will be recorded in the currently edited VSCode script.</p></li>
<li><p>In addition, the “GOM script commands” subsection of the output tab shows a log of the executed commands.</p>
<p><img alt="" src="../../../_images/recording1.png" /></p>
</li>
</ul>
</li>
<li><p>For recording into a different position of the script, set the cursor to that line first or while recording.</p></li>
<li><p>Press “Record commands” again to stop command recording.</p></li>
</ol>
</section>
<section id="inserting-elements">
<h3>Inserting elements<a class="headerlink" href="#inserting-elements" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>Elements in the GOM applications are represented by ‘element references’ in the script. These are python expressions which, when executed, return a reference to that element.</p>
</div></blockquote>
<ol class="arabic">
<li><p>When connected to a GOM application host, select the ‘Elements’ in the explorer view.</p>
<ul class="simple">
<li><p>There, all elements in the project are listed.</p></li>
</ul>
</li>
<li><p>Set editor cursor to the place the element should be into inserted into.</p></li>
<li><p>Select “Insert element into editor” from the top toolbar of the ‘Elements’ tab</p>
<ul>
<li><p>You will get an ‘element reference’, an expression which, when, executed, returns the element referenced.</p>
<p><img alt="" src="../../../_images/inserting_elements.png" /></p>
</li>
</ul>
</li>
</ol>
</section>
<section id="inserting-keywords">
<h3>Inserting keywords<a class="headerlink" href="#inserting-keywords" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>A keyword is an attribute used to query an element property. Various element attributes are existing depending on the element type.</p>
</div></blockquote>
<ol class="arabic">
<li><p>Insert an element reference in the script as mentioned above.</p></li>
<li><p>After the element reference, press ‘.’ to insert a point</p>
<ul>
<li><p>A selection menu opens presenting the available keywords for that element</p>
<p><img alt="" src="../../../_images/inserting_keywords.png" /></p>
</li>
</ul>
</li>
</ol>
</section>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this heading"></a></h2>
<section id="start-debugging">
<h3>Start debugging<a class="headerlink" href="#start-debugging" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Prepare debugged script as usual by setting breakpoints etc.</p>
<p><img alt="" src="../../../_images/debugging1.png" /></p>
</li>
<li><p>Start debugger by selecting “Debug script in GOM host” from the editor toolbar</p>
<p><img alt="" src="../../../_images/debugging2.png" /></p>
</li>
<li><p>Full VSCode debugging functionality can be used now, including</p>
<p><img alt="" src="../../../_images/debugging3.png" /></p>
<ul class="simple">
<li><p>breakpoints and triggered breaks,</p></li>
<li><p>step over/in/out,</p></li>
<li><p>tracebacks,</p></li>
<li><p>variable inspection etc.</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="user-defined-script-dialogs">
<h2>User defined script dialogs<a class="headerlink" href="#user-defined-script-dialogs" title="Permalink to this heading"></a></h2>
<section id="create-new-script-dialog">
<h3>Create new script dialog<a class="headerlink" href="#create-new-script-dialog" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Select “GOM Scripting: Insert new user defined script dialog” from the command selector or from the right mouse menu while editing the script the dialog should be inserted into.</p>
<p><img alt="" src="../../../_images/userdialog1.png" /></p>
</li>
<li><p>Choose a name for the dialog file which will then be created.</p>
<p><img alt="" src="../../../_images/userdialog2.png" /></p>
</li>
<li><p>The edited script will contain the necessary dialog commands then and a separate dialog definition file (*.gdlg) has been created.</p>
<p><img alt="" src="../../../_images/userdialog3.png" /></p>
</li>
<li><p>Select the dialog definition file to open the build-in dialog editor. Edit dialog via drag/drop and configuration operations like in the applications script editor.</p>
<p><img alt="" src="../../../_images/userdialog4.png" /></p>
</li>
<li><p>When the script is executed, the user defined script dialog is displayed.</p>
<p><img alt="" src="../../../_images/userdialog5.png" /></p>
</li>
<li><p>In addition, dialog definition files (*.gdlg) can be viewed edit edited in the embedded script editor, too:</p>
<p><img alt="" src="../../../_images/userdialog6.png" /></p>
</li>
</ol>
</section>
</section>
<section id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this heading"></a></h2>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h3>
<section id="how-do-i-set-a-shortcut-to-toggle-the-recording-mode">
<h4>How do I set a shortcut to toggle the recording mode ?<a class="headerlink" href="#how-do-i-set-a-shortcut-to-toggle-the-recording-mode" title="Permalink to this heading"></a></h4>
<ul>
<li><p>Select the “Keyboard Shortcuts” properties from the configurations menu:</p>
<p><img alt="" src="../../../_images/toggle_recording_1.png" /></p>
</li>
<li><p>Assign the command “GOM Scripting: Toggle recording” to a key:</p>
<p><img alt="" src="../../../_images/toggle_recording_2.png" /></p>
</li>
<li><p>The ‘when’ clause determines when the command is available. The correct ‘when’ clause here ist:</p>
<p>resourceLangId == python &amp;&amp; scriptingHostConnected</p>
</li>
<li><p>If necessary, existing command bindings to that key can be removed here, too:</p>
<p><img alt="" src="../../../_images/toggle_recording_3.png" /></p>
</li>
</ul>
</section>
<section id="how-do-i-set-shortcuts-for-starting-the-current-script-in-the-gom-host">
<h4>How do I set shortcuts for starting the current script in the GOM host ?<a class="headerlink" href="#how-do-i-set-shortcuts-for-starting-the-current-script-in-the-gom-host" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>See above for the general process.</p></li>
<li><p>The relevant commands here are:</p>
<ul>
<li><p>‘GOM Scripting: Run script in GOM host’: Start the script.</p></li>
<li><p>‘GOM Scripting: Debug script in GOM host’: Start the script with debugger attached.</p></li>
</ul>
</li>
<li><p>F9 / CTRL + F9 might be valid keys for that.</p></li>
</ul>
</section>
</section>
<section id="script-editing">
<h3>Script editing<a class="headerlink" href="#script-editing" title="Permalink to this heading"></a></h3>
<section id="can-i-use-local-workspaces-from-disk-instead-of-the-application-script-database-for-my-project">
<h4>Can I use local workspaces from disk instead of the application script database for my project ?<a class="headerlink" href="#can-i-use-local-workspaces-from-disk-instead-of-the-application-script-database-for-my-project" title="Permalink to this heading"></a></h4>
<ul>
<li><p>Yes.</p></li>
<li><p>You can add arbitrary folders to the workspace and edit and starts scripts from right there.</p></li>
<li><p>A limitation is that environments and packages cannot yet be handled by VSCode. As a workaround, the edited external folder can be added to the internal script editor, so that it can be processed from there:</p>
<p><img alt="" src="../../../_images/script_editing_1.png" /></p>
</li>
</ul>
</section>
</section>
<section id="dialog-editing">
<h3>Dialog editing<a class="headerlink" href="#dialog-editing" title="Permalink to this heading"></a></h3>
<section id="i-cannot-edit-all-aspects-of-the-user-defined-script-dialogs-in-visual-studio-code">
<h4>I cannot edit all aspects of the user defined script dialogs in visual studio code ?<a class="headerlink" href="#i-cannot-edit-all-aspects-of-the-user-defined-script-dialogs-in-visual-studio-code" title="Permalink to this heading"></a></h4>
<ul>
<li><p>The user defined script editor is under development and probably still missing various features.</p></li>
<li><p>Workaround:</p>
<ul>
<li><p>Create the dialog in VSCode. If features are missing…</p>
<p><img alt="" src="../../../_images/dialog_editing_1.png" /></p>
</li>
<li><p>…continue editing the dialog in the build-in script editor.</p>
<p><img alt="" src="../../../_images/dialog_editing_2.png" /></p>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h3>
<section id="when-using-intellisense-completion-the-keyword-list-stalls">
<h4>When using IntelliSense completion, the keyword list stalls<a class="headerlink" href="#when-using-intellisense-completion-the-keyword-list-stalls" title="Permalink to this heading"></a></h4>
<ul>
<li><p>When using the ‘.’ or a hotkey to access the list of possible completions, a tooltip displays ‘Loading…’ but nothing happens:</p>
<p><img alt="" src="../../../_images/keyword_list_1.png" /></p>
</li>
<li><p>This bug is caused by the ‘Microsoft Python’ extension in connection with the script database filesystem.</p></li>
<li><p>There is currently no fix, so disabling this extension is the only way here. This does not affect most python editor features:</p>
<p><img alt="" src="../../../_images/keyword_list_2.png" /></p>
</li>
</ul>
</section>
<section id="when-starting-both-the-application-and-a-script-from-within-visual-studio-code-crashes-can-happen">
<h4>When starting both the application and a script from within Visual Studio Code, crashes can happen<a class="headerlink" href="#when-starting-both-the-application-and-a-script-from-within-visual-studio-code-crashes-can-happen" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>This is more a GOM internal issue. When developing application code and script code at the same time from the same VSCode instance, this can happen.</p></li>
<li><p>The parallel debugging session (application and scripting) seem to be the problem.</p></li>
<li><p>Workaround: Do not start GOM application via the VSCode launcher, but e.g. from a command prompt.</p></li>
</ul>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Carl Zeiss GOM Metrology GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>